<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EngTrain App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="header">
    <h1>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ EngTrain App!</h1>
  </div>

  <div class="content">
    <h2>–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã:</h2>

    <button class="btn" onclick="navigateTo('grammar.html')">üìö Grammar</button>
    <button class="btn" onclick="navigateTo('vocabulary.html')">üß† Vocabulary</button>
    <button class="btn" onclick="navigateTo('practice.html')">‚úçÔ∏è Practice</button>
    <button class="btn" onclick="navigateTo('games.html')">üéÆ –ò–≥—Ä—ã</button>
    <button class="btn secondary" onclick="navigateTo('full-version.html')">üîê –ß—Ç–æ –≤ –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏?</button>
    <button class="btn" onclick="navigateTo('test.html')" style="background-color: #28a745;">üß™ –¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</button>
    <button class="btn" onclick="testNavigation()" style="background-color: #ff6b6b;">üîß –¢–µ—Å—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ</button>
    <button class="btn" onclick="testDirectNavigation()" style="background-color: #ffa500;">üöÄ –ü—Ä—è–º–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è</button>
    <button class="btn" onclick="testTelegramNavigation()" style="background-color: #9c27b0;">üì± –¢–µ—Å—Ç Telegram</button>
    <button class="btn" onclick="simpleTest()" style="background-color: #e91e63;">üî¨ –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç</button>
  </div>

  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
    if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
      Telegram.WebApp.ready();
      Telegram.WebApp.expand();
      console.log('Telegram Web App initialized');
    }

    function navigateTo(page) {
      console.log('=== NAVIGATION DEBUG ===');
      console.log('Navigating to:', page);
      console.log('Current URL:', window.location.href);
      console.log('Current pathname:', window.location.pathname);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏–º—Å—è –ª–∏ –º—ã –≤ Telegram Web App
      if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
        console.log('Telegram Web App detected');
        
        try {
          // –î–ª—è Telegram Web App –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥
          console.log('Using Telegram Web App navigation');
          
          // –ü–æ–ø—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram Web App API –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
          if (Telegram.WebApp.openTelegramLink) {
            console.log('Using Telegram.WebApp.openTelegramLink');
            const currentUrl = window.location.href;
            const baseUrl = currentUrl.substring(0, currentUrl.lastIndexOf('/') + 1);
            const newUrl = baseUrl + page;
            Telegram.WebApp.openTelegramLink(newUrl);
          } else {
            console.log('Using fallback navigation');
            window.location.href = page;
          }
          
        } catch (error) {
          console.error('Telegram navigation error:', error);
          // Fallback –∫ –æ–±—ã—á–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
          window.location.href = page;
        }
      } else {
        console.log('Browser mode detected');
        // –û–±—ã—á–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
        try {
          window.location.href = page;
        } catch (error) {
          console.error('Browser navigation error:', error);
          window.open(page, '_self');
        }
      }
    }
    
    function testNavigation() {
      console.log('Testing navigation...');
      alert('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏...\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–∂–∞—Ç—å –Ω–∞ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É –≤—ã—à–µ.');
    }
    
    function testDirectNavigation() {
      console.log('=== DIRECT NAVIGATION TEST ===');
      console.log('Testing direct navigation to grammar.html');
      
      // –ü–æ–ø—Ä–æ–±—É–µ–º –ø—Ä—è–º—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é
      try {
        console.log('Direct navigation attempt...');
        window.location.href = 'grammar.html';
      } catch (error) {
        console.error('Direct navigation failed:', error);
        alert('–ü—Ä—è–º–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞. –û—à–∏–±–∫–∞: ' + error.message);
      }
    }
    
    function testTelegramNavigation() {
      console.log('=== TELEGRAM NAVIGATION TEST ===');
      
      if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
        console.log('Telegram Web App detected');
        console.log('Telegram Web App info:', Telegram.WebApp);
        
        alert('Telegram Web App –æ–±–Ω–∞—Ä—É–∂–µ–Ω!\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É "üìö Grammar" –≤—ã—à–µ.');
      } else {
        console.log('Telegram Web App not detected');
        alert('Telegram Web App –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω.\n–≠—Ç–æ—Ç —Ç–µ—Å—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ Telegram.');
      }
    }

    function simpleTest() {
      console.log('=== SIMPLE TEST ===');
      console.log('Testing simple navigation to grammar.html');
      try {
        window.location.href = 'grammar.html';
        console.log('Simple navigation successful.');
      } catch (error) {
        console.error('Simple navigation failed:', error);
        alert('–ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª. –û—à–∏–±–∫–∞: ' + error.message);
      }
    }
  </script>
</body>
</html>
